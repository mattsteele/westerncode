---
import Sun from "../assets/svgs/sun.svg";
import MoonStars from "../assets/svgs/moon-stars.svg";
---

<theme-toggle>
	<button
		type="button"
		class="p-2 rounded-md text-gray-800 hover:text-rose-700 dark:text-white dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-rose-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-colors duration-200"
		aria-label="Toggle between light and dark mode"
	>
		<span class="hidden dark:block" aria-hidden="true">
			<Sun width="28" height="28" />
		</span>
		<span class="dark:hidden" aria-hidden="true">
			<MoonStars width="28" height="28" />
		</span>
	</button>
</theme-toggle>

<script>
	import { applyTheme, getPreferredTheme } from "../utils/theme";

	class ThemeToggle extends HTMLElement {
		constructor() {
			super();
			if (typeof window === "undefined") return;
			
			const button = this.querySelector("button");
			if (!button) return;

			button.addEventListener("click", () => {
				const currentTheme = document.documentElement.classList.contains("dark") ? "dark" : "light";
				applyTheme(currentTheme === "dark" ? "light" : "dark");
			});

			button.addEventListener("keydown", (e) => {
				if (e.key === "Enter" || e.key === " ") {
					e.preventDefault();
					button.click();
				}
			});
		}
	}

	customElements.define("theme-toggle", ThemeToggle);
</script>
